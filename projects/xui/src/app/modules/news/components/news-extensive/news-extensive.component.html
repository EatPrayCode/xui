<div class="">

    <nav mat-tab-nav-bar class="d-none d-sm-flex">
        <a mat-tab-link *ngFor="let e of examples" (click)="handleClickSubTab(e)" routerLinkActive
            #rla="routerLinkActive" [active]="rla.isActive" [disabled]="e.auth && !(isAuthenticated$ | async)">
            {{e.link}}
            <!-- {{e.about?.title || 'noname'}} {{e.newCount}} -->
        </a>
    </nav>

    <nav class="nav-responsive d-sm-none d-flex justify-content-center">
        <mat-select [(value)]="selectedValue">
            <mat-option *ngFor="let e of examples" [value]="e" (click)="handleClickSubTab(e)"
                [disabled]="e.auth && !(isAuthenticated$ | async)">
                {{e.link}}
            </mat-option>
        </mat-select>
    </nav>

</div>


<!-- <span *ngIf="feeds$ | async as items">
    {{items|json}}
</span> -->

<div class="basic-container" *ngIf="feeds$ | async as itemsList">
    <mat-toolbar>
        <button mat-icon-button (click)="toggleView();">
            <mat-icon>{{ ( isListView ) ? 'view_module' : 'view_list' }}</mat-icon>
        </button>
        <button mat-icon-button (click)="addNewsPublication();">
            <mat-icon>add</mat-icon>
        </button>
    </mat-toolbar>
    <mat-grid-list cols="{{numCols}}" rowHeight="{{rowHeight}}" [gutterSize]="gutterSize">
        <mat-grid-tile *ngFor="let item of itemsList" class="item-bg" [ngStyle]="{'background-image': 'url(' + item.publicationImage[0].url + ')'}" >
            <mat-card fxFlexFill fxLayoutAlign="center center" class="item-bg">
                {{item.publicationName}}
            </mat-card>
        </mat-grid-tile>
    </mat-grid-list>
</div>

<div class="container p-1 mb-2" style="background-color:rgba(255,248,220,0.5)">
    <div class="feeds-header">
        <h2 class="mr-auto">Feeds</h2>
        <button class="a-button button-share mr-1" (click)="share()" *ngIf="shareIsSuported">
            <img src="assets/share.svg" alt="Share feeds">
        </button>
        <button class="a-button green" (click)="refreshFeeds()">
            Refresh all feeds <span class="spinner" *ngIf="loading"></span>
        </button>

        <div>
            <div class="mt-1">
                <button class="a-button lh-20" (click)="addFeedMode=true">+ add</button>
            </div>
            <div>
                <form class="pure-form pure-form-stacked">
                    <fieldset>
                        <label for="new-feeds">Enter new feed URLs</label>
                        <textarea class="pure-input-1" [(ngModel)]="rawFeedURLs" name="rawFeedURLs" id=new-feeds
                            [placeholder]="['https://example.com/feed1\nhttps://example.com/feed2']"></textarea>

                        <button type="button" (click)="addFeeds(rawFeedURLs)" class="a-button lh-20">Add to the
                            feeds</button>
                    </fieldset>
                </form>
            </div>
        </div>
    </div>

    <div class="feed-line" *ngFor="let feed of feeds; trackBy:identify" [ngClass]="{loading: feedLoading[feed.id]}">
        <div class="mr-1">
            <strong class="fit-text">{{feed.about?.title || 'noname'}}</strong><br>
            <small class="fit-text">{{feed.url}}</small>
            <div *ngIf="feedError[feed.id]" style="color: #82280c" class="fit-text">
                <small>ðŸ’¢ {{feedError[feed.id]}}</small>
            </div>
        </div>
        <div class="ml-auto" style="text-align: right;">
            <button class="a-button button-counter" [disabled]="feedLoading[feed.id]"
                [routerLink]="['/news/news-feed/', feed.id]">
                <span class="spinner" *ngIf="feedLoading[feed.id]"></span>
                <span *ngIf="!feedLoading[feed.id]">
                    <span class="new-info" *ngIf="feed.newCount">
                        +{{ feed.newCount }}
                    </span>
                    <span *ngIf="!feed.newCount">
                        {{feed.count || '-'}}
                    </span>
                </span>

            </button>
        </div>
    </div>

</div>